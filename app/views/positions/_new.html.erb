<div class="row">
  <div class="col-md-12">
    <%= form_for @position, url: positions_path(@portfolio), remote: true do |f| %>
      <%= render "shared/error_messages", object: f.object %>
      <table id="addPosition">
        <tr>
          <th><%= f.label :date_acquired %></th>
          <th><%= f.label :symbol %></th>
          <th><%= f.label :shares %></th>
          <th><%= f.label :cost_per_share %></th>
        </tr>
        <tr>
          <td><%= f.text_field :date_acquired %></td>
          <td><%= f.text_field :symbol, id: 'check_symbol' %></td>
          <td><%= f.text_field :shares %></td>
          <td><%= f.text_field :cost_per_share %></td>
          <td><%= f.submit "Add Position", class: "btn btn-primary" %></td>
        </tr>
      </table>
    <% end %>
  </div>
</div>

<script type="text/javascript">
var YAHOO = {
  Finance: {
    SymbolSuggest: {}
  }
};

$("#check_symbol").autocomplete({
  source: function(request, response) {
    $.ajax({
      type: "GET",
      url: "http://autoc.finance.yahoo.com/autoc",
      dataType: "jsonp",  
      jsonp: "callback",
      jsonpCallback: "YAHOO.Finance.SymbolSuggest.ssCallback",
      data: {
        query: request.term
      },
      cache: true
    });
    YAHOO.Finance.SymbolSuggest.ssCallback = function(data) {
      response($.map(data.ResultSet.Result, function(item) {
        return {
          label: item.symbol + " " + item.name,
          value: item.symbol
        };
      }));
    };
  },
  minLength: 1,
  select: function(event, ui) {
    $("#check_symbol").val(ui.item.symbol);
  }
});

</script>